「作業達成確認チェックシート」
（対象ブランチ：`Feature/0824 workbanch`。ブランチ名はシェルで `"Feature/0824 workbanch"` とクォートしてください）

---

# 作業達成確認チェックシート（AIエージェント用 / 2025-08-25）

## 実行順（短縮）

1. ブランチ準備 → 2) 依存導入 → 3) 静的確認 → 4) テスト実行 → 5) CI 確認 → 6) ドキュメント有無

## チェックテーブル（合計=100）

| No | チェック項目     | コマンド                                                                                                          | 期待       | 重み(%) | 状態   |      |
| -- | ---------- | ------------------------------------------------------------------------------------------------------------- | -------- | ----: | ---- | ---- |
| 1  | ブランチ切替     | `git checkout "Feature/0824 workbanch" && git rev-parse --abbrev-ref HEAD`                                    | ブランチ名一致  |     5 | \[ ] |      |
| 2  | dev依存導入    | `python -m pip install -U pip && pip install -r requirements.txt && pip install -r requirements-dev.txt`      | 正常終了     |     8 | \[ ] |      |
| 3  | conftest存在 | `test -f tests/conftest.py && echo OK`                                                                        | `OK`     |     5 | \[x] |      |
| 4  | 解析正規表現修正①  | `grep -q 're\\.MULTILINE' tests/test_metrics_counters.py && echo OK`                                          | `OK`     |     6 | \[x] |      |
| 5  | 解析正規表現修正②  | `grep -q '\\(\\?:' tests/test_metrics_counters.py && echo OK`                                                 | `OK`     |     6 | \[x] |      |
| 6  | CIブランチ対象   | `grep -q 'Feature/0824 workbanch' .github/workflows/ci.yml && echo OK`                                        | `OK`     |     6 | \[x] |      |
| 7  | CI固定ENV    | `grep -q 'DATABASE_URL: postgresql://127.0.0.1/newshub' .github/workflows/ci.yml && echo OK`                  | `OK`     |     6 | \[x] |      |
| 8  | カウンタ厳密検証   | `pytest -q tests/test_metrics_counters.py`                                                                    | 0 failed |    14 | \[ ] |      |
| 9  | 非同期デコレータ   | `pytest -q tests/test_metrics_async.py`                                                                       | 0 failed |    10 | \[ ] |      |
| 10 | インテグレーション  | `pytest -q tests/test_metrics_integration.py`                                                                 | 0 failed |    10 | \[ ] |      |
| 11 | 環境固定テスト    | `pytest -q tests/test_ci_env.py`                                                                              | 0 failed |     8 | \[ ] |      |
| 12 | ドキュメント有無   | \`git ls-files docs/作業報告書0824v2-追補.md grafana/dashboard.json docs/ops/grafana.md scripts/benchmark\_search.py | wc -w\`  |  件数=4 | 10   | \[x] |

### 進捗計算（例）

* 各行を達成したら「状態」をチェック（✓）。
* `進捗(%) = 達成した行の重み(%) 合計`（上限 100）。

## 付記（最小トラブルシュート）

* `tests/test_metrics_counters.py` 失敗時：`prometheus_client` が未導入なら `pip install prometheus_client`。正規表現は **`re.MULTILINE`** と **`(?:...)?`** を含むこと。
* CI 緑化：`.github/workflows/ci.yml` にブランチ名 **`Feature/0824 workbanch`** が含まれること（クォート必須）。
* import 時 DB 接続が走る実装が残っている場合は**遅延初期化**に変更（今回テストは接続不要前提）。

この表を `docs/daily/2025-08-25.md` に貼り付けて日次ログ化してください。
